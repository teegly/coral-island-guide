<app-list-detail-container [removePlaceholder]="showTable">
    @if (selectedEntity) {
        <app-item-card-switch [item]="selectedEntity" listDetail>
            <ng-template let-details appDatabaseItemDetails>
                <app-offering [details]="details"/>
            </ng-template>
        </app-item-card-switch>
    }
    <div class="flex flex-col md:flex-row gap-4 md:gap-8 mb-12">
        <h1 class="font-semibold text-3xl text-white flex items-center gap-x-4">
            My Coral Guide
        </h1>
        <app-user-data-actions/>
    </div>
    <app-dashboard-filter [parentFormGroup]="filterFormGroup" class="my-5 block"/>
    @if (requests$ | async) {

        <section class="my-2">
            <h2 class="mt-6 mb-3 font-semibold text-2xl text-white">
                Birthdays
            </h2>
            <app-card class="@container">
                <div class="@3xl:grid-cols-2 grid gap-x-3 gap-y-5">
                    <div>
                        <h2 class="mb-4 font-semibold text-2xl text-black">
                            Today
                        </h2>
                        <app-birthday-dashboard [birthdays]="birthdaysToday()" [currentDate]="currentDateString()" (itemClicked)="showDetails($event)"/>
                    </div>
                    <div>
                        <h2 class="mb-4 font-semibold text-2xl text-black">
                            Tomorrow
                        </h2>
                        <app-birthday-dashboard [birthdays]="birthdaysTomorrow()" [currentDate]="currentDateString()" (itemClicked)="showDetails($event)"/>
                    </div>
                </div>
            </app-card>
        </section>
        <section class="my-2">
            <h2 class="mt-6 mb-3 font-semibold text-2xl text-white">
                Fish
            </h2>

            <div class="icon-grid">
                @for (entry of fish(); track entry.entry.id + entry.context) {
                    <!--                    [class.selected-icon]="selectedEntity?entry.id === entry.entry.id"        -->
                    <div [class.checklist-checked]="entry.completed"
                         class="icon-grid-item checklist-item  flex flex-col">
                        <app-item-icon
                                (click)="showDetails({id: entry.entry.id, displayName: '', iconName: entry.entry.iconName})"
                                [itemName]="entry.entry.iconName"/>
                        <label class="text-white flex justify-center" for="entry-{{entry.entry.id}}-input">
                            <mat-checkbox class="flex" id="entry-{{entry.entry.id}}"
                                          [checked]="entry.completed"
                                          (change)="updateChecklist($event, entry.entry.id, entry.context); entry.completed = !entry.completed"
                                          name="entry-{{entry.entry.id}}"></mat-checkbox>
                        </label>
                    </div>
                } @empty {
                    <p class="col-span-full text-white">No more fish to catch :)</p>
                }
            </div>
        </section>
        <section class="my-2">
            <h2 class="mt-6 mb-3 font-semibold text-2xl text-white">
                Insects
            </h2>

            <div class="icon-grid">
                @for (entry of insects(); track entry.entry.id + entry.context) {
                    <!--                    [class.selected-icon]="selectedEntity?entry.id === entry.entry.id"        -->
                    <div [class.checklist-checked]="entry.completed"
                         class="icon-grid-item checklist-item  flex flex-col">
                        <app-item-icon
                                (click)="showDetails({id: entry.entry.id, displayName: '', iconName: entry.entry.iconName})"
                                [itemName]="entry.entry.iconName"/>
                        <label class="text-white flex justify-center" for="entry-{{entry.entry.id}}-input">
                            <mat-checkbox class="flex" id="entry-{{entry.entry.id}}"
                                          [checked]="entry.completed"
                                          (change)="updateChecklist($event, entry.entry.id, entry.context); entry.completed = !entry.completed"
                                          name="entry-{{entry.entry.id}}"></mat-checkbox>
                        </label>
                    </div>
                } @empty {
                    <p class="col-span-full text-white">No more bugs to catch :)</p>
                }
            </div>
        </section>
        <section class="my-2">
            <h2 class="mt-6 mb-3 font-semibold text-2xl text-white">
                Ocean critters
            </h2>

            <div class="icon-grid">
                @for (entry of oceanCritter(); track entry.entry.id + entry.context) {
                    <!--                    [class.selected-icon]="selectedEntity?entry.id === entry.entry.id"        -->
                    <div [class.checklist-checked]="entry.completed"
                         class="icon-grid-item checklist-item  flex flex-col">
                        <app-item-icon
                                (click)="showDetails({id: entry.entry.id, displayName: '', iconName: entry.entry.iconName})"
                                [itemName]="entry.entry.iconName"/>
                        <label class="text-white flex justify-center" for="entry-{{entry.entry.id}}-input">
                            <mat-checkbox class="flex" id="entry-{{entry.entry.id}}"
                                          [checked]="entry.completed"
                                          (change)="updateChecklist($event, entry.entry.id, entry.context); entry.completed = !entry.completed"
                                          name="entry-{{entry.entry.id}}"></mat-checkbox>
                        </label>
                    </div>
                } @empty {
                    <p class="col-span-full text-white">No more ocean critters to catch :)</p>
                }
            </div>
        </section>
    } @else {
        @defer (on immediate) {
            <mat-spinner class="mx-auto"/>
        }
    }
</app-list-detail-container>
